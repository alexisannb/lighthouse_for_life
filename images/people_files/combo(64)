YUI.add("hermes-template-notif-item-upload",function(e,t){var a=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,t,a,i,n){var l,s,p=e.escapeExpression;return'<div class="notification-item notif-item-upload">\n\t<span class="notification-type">NotificationType: '+p("function"==typeof(s=null!=(s=a.type||(null!=t?t.type:t))?s:a.helperMissing)?s.call(null!=t?t:{},{name:"type",hash:{},data:n}):s)+'</span>\n\t<div class="entity-type">ObjectType: '+p(e.lambda(null!=(l=null!=t?t.activityData:t)?l.objectType:l,t))+"</div>\n</div>\n"},useData:!0}),i={};e.Array.each([],function(t){var a=e.Template.get("hermes/"+t);a&&(i[t]=a)}),e.Template.register("hermes/notif-item-upload",function(t,n){return n=n||{},n.partials=n.partials?e.merge(i,n.partials):i,a(t,n)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("notifications-helper",function(e,t){var n=require("hermes-core/flog")(t),i=e.mix({langBundles:["notifications","relative-dates","profile","photo-card","header"]},e.Localizable),o={fave:"notif-item-fave",comment:"notif-item-comment",reply_reply:"notif-item-reply-reply",group_topic_new:"notif-item-group-topic-new",contacted:"notif-item-contacted",group_invite:"notif-item-group-invite",note:"notif-item-note",tag:"notif-item-tag",people:"notif-item-people",testimonial:"notif-item-testimonial",group_user_invite:"notif-item-group-user-invite",flickrmail:"notif-item-flickrmail",photo_comment_mention:"notif-item-photo-comment-mention",gallery:"notif-item-gallery",gallery_comment:"notif-item-gallery-comment",share:"notif-item-share",photo_accepted:"notif-item-photo-accepted",photo_declined:"notif-item-photo-declined",photo_mention:"notif-item-photo-mention",group_blast:"notif-item-group-blast",upload:"notif-item-upload"},a=50;e.NotificationsHelper=function(t,l){function r(e){var t=e.getSizeToFit({width:a,height:a},{sizes:e.getValue("sizes"),cropToFit:!0,includeSquare:!0});return{id:e.getValue("id"),url:e.getValue("url"),displayUrl:t.displayUrl}}function s(t,n){var i,o=[],a=[];return n=n||t.eventDataList[0].objectType,o.push(c[t.activityData.objectType].extractEntityModel(t.activityData).then(function(e){i=e})),t.eventDataList.forEach(function(e){o.push(c[n].extractEntityModel(e).then(function(e){a.push(e)}))}),e.Promise.all(o).then(function(){return{activityEntityModel:i,eventEntityModels:a}})}function u(e,t){return e.setValue("isContact",t),e.remoteUpdate().catch(function(t){e.setValue("isContact",!1),n.error({err:t})})}function p(e,t){return e.setValue("isIgnored",t),t&&e.setValue("isContact",!1),e.remoteUpdate().catch(function(t){e.setValue("isContact",!1),n.error({err:t})})}var m,c,d,g=new e.TemplateLibraryHelper(t,{localizeLib:i});c={photo:{extractEntityModel:function(n){return e.FlickrPromise({photoModelRegistry:t.getModelRegistry("photo-models"),personModelRegistry:t.getModelRegistry("person-models"),photoEngagementModelRegistry:t.getModelRegistry("photo-engagement-models"),photoStatsRegistry:t.getModelRegistry("photo-stats-models")}).then(function(t){var i=e.clone(n.photo);if(i.title){var o=i.title.content||i.title._content;i.title=o}return e.APIHelper.response.parsePhotos({photos:[i],photoModelRegistry:t.photoModelRegistry,personModelRegistry:t.personModelRegistry,photoEngagementModelRegistry:t.photoEngagementModelRegistry,photoStatsModelRegistry:t.photoStatsRegistry}).shift()})}},set:{extractEntityModel:function(e){return e}},gallery:{extractEntityModel:function(n){return e.FlickrPromise({galleryModelRegistry:t.getModelRegistry("notification-gallery-models")}).then(function(e){return e.galleryModelRegistry.addOrUpdate(e.galleryModelRegistry.parseGalleryModel(n))})}},person:{extractEntityModel:function(n){return e.FlickrPromise({personModelRegistry:t.getModelRegistry("person-models")}).then(function(t){var i=n.person;return t.personModelRegistry.addOrUpdate(e.APIHelper.response.parsePerson({nsid:i.user,pathAlias:i.pathAlias,username:i.username,realname:i.realname,isAdFree:i.isAdFree,ispro:i.ispro,proBadge:i.proBadge,datecreate:i.datecreate,iconurls:i.iconurls}))})}},flickrmail:{extractEntityModel:function(n){return e.FlickrPromise({flickrMailModelRegistry:t.getModelRegistry("notification-flickrmail-models")}).then(function(e){return e.flickrMailModelRegistry.addOrUpdate(e.flickrMailModelRegistry.parseFlickrMailModel(n))})}},group:{extractEntityModel:function(n){return e.FlickrPromise({groupModelRegistry:t.getModelRegistry("group-models")}).then(function(e){return e.groupModelRegistry.addOrUpdate(e.groupModelRegistry.parseGroupModel(n.id,n.pathAlias,n))})}},discussion:{extractEntityModel:function(n){return e.FlickrPromise({groupModelRegistry:t.getModelRegistry("group-models"),discussionModelRegistry:t.getModelRegistry("notification-group-discussion-models")}).then(function(t){var i,o;return o=e.clone(n),o.id=n.group_id,o.title=n.group_name,i=t.groupModelRegistry.addOrUpdate(t.groupModelRegistry.parseGroupModel(n.group_id,n.pathAlias,o)),t.discussionModelRegistry.add(t.discussionModelRegistry.parseDiscussionModel(n.id,n.pathAlias,n,i))})}},testimonial:{extractEntityModel:function(e){return e}}},d={person:{loadConfig:function(n){n.item;var i=[];return i.push(d.default.loadConfig(n)),i.push(t.getModel("person-relationship-models",n.personModel.getValue("nsid"))),e.Promise.all(i).then(function(e){return{contextMenuType:"person",item:n.item,personModel:n.personModel,relationshipModel:e[1]}})},getConfig:function(n){var o;return(o=d.default.getConfig(n)).actionList.push({actionId:"sendMessage",text:i.intlMessage({intlName:"photo-card.SEND_A_MESSAGE"}),onSelected:function(t){e.config.win.open(e.URLHelper.generatePersonUrls(n.personModel).sendFlickrMail,"_blank")}}),n.relationshipModel.getValue("isIgnored")||(n.relationshipModel.getValue("isContact")?o.actionList.push({actionId:"unfollowOwner",text:i.intlHTMLMessage({intlName:"photo-card.UNFOLLOW_USER",username:n.personModel.getValue("displayname")}),onSelected:function(e){u(n.relationshipModel,!1)}}):o.actionList.push({actionId:"followOwner",text:i.intlHTMLMessage({intlName:"photo-card.FOLLOW_USER",username:n.personModel.getValue("displayname")}),onSelected:function(e){u(n.relationshipModel,!0)}})),n.relationshipModel.getValue("isIgnored")?o.actionList.push({actionId:"unblockOwner",text:i.intlHTMLMessage({intlName:"photo-card.UNBLOCK_USER",username:n.personModel.getValue("displayname")}),onSelected:function(e){p(n.relationshipModel,!1)}}):o.actionList.push({actionId:"blockOwner",text:i.intlHTMLMessage({intlName:"photo-card.BLOCK_USER",username:n.personModel.getValue("displayname")}),onSelected:function(o){!(function(n,o){var a=new e.Views.FluidModal({appContext:t,title:i.intlHTMLMessage({intlName:"photo-card.BLOCK_USER_QUESTION",username:o}),message:"<p>"+i.intlMessage({intlName:"photo-card.BLOCK_CONFIRM_MESSAGE"})+"</p><p>"+i.intlHTMLMessage({intlName:"photo-card.BLOCK_CONFIRM_MESSAGE_NOTE"})+"</p>",actionButtonIsDangerous:!0,actionButtonLabel:i.intlMessage({intlName:"header.BLOCK"}),overlayClassList:"over-droparound-under-modal"});a.show(),a.on("actionClick",function(){p(n,!0)})})(n.relationshipModel,n.personModel.getValue("displayname"))}}),o}},default:{loadConfig:function(t){return e.Promise.resolve()},getConfig:function(e){var t={actionList:[]};return e.item.activityData.isMuted?t.actionList.push({actionId:"unmuteNotification",text:"TMP Unmute this notification",onSelected:function(e){console.log("unmute!")}}):t.actionList.push({actionId:"muteNotification",text:"TMP Mute this notification",onSelected:function(e){console.log("mute!")}}),t}}},m={fave:{extractEntitiesFromResponse:function(e){return s(e)},setupView:function(e){return t.getView("base-notification-item-view",{activityItem:e}).then(function(e){return e.initialize()})},constructTemplateConfig:function(n){var o;if("person"===n.activityData.objectType){var a=n.activityEntityModel,l=n.eventEntityModels;return o=i.intlHTMLMessage({intlName:"notifications.NOTIF_1_PERSON_FAVED_X_PHOTOS",personName:a.getValue("displayname"),personUrl:a.getValue("url"),photoCountString:n.eventEntityModels.length,mediaType:l[0].getValue("mediaType")}),{headline:o,timestamp:n.timestamp,avatarData:{id:a.getValue("id"),type:n.activityData.objectType,iconUrl:a.getValue("buddyicon").small,url:a.getValue("url")},photos:l.map(function(e){return r(e)}).slice(0,12),hasMultiplePhotos:l.length>1}}if("photo"===n.activityData.objectType){var s=n.activityEntityModel,u=n.eventEntityModels;return o=u.length>1?i.intlHTMLMessage({intlName:"notifications.NOTIF_X_PEOPLE_FAVED_1_PHOTO",personName:u[0].getValue("displayname"),personUrl:u[0].getValue("url"),personCountString:e.IntlNumber.format(u.length,t.lang,1),photoTitle:s.getValue("title"),photoUrl:s.getValue("url")}):i.intlHTMLMessage({intlName:"notifications.NOTIF_1_PERSON_FAVED_1_PHOTO",personName:u[0].getValue("displayname"),personUrl:u[0].getValue("url"),photoTitle:s.getValue("title"),photoUrl:s.getValue("url")}),{headline:o,timestamp:n.timestamp,avatarData:{id:u[0].getValue("id"),type:"person",iconUrl:u[0].getValue("buddyicon").small,url:u[0].getValue("url")},photo:r(s)}}},loadContextMenuConfig:function(e){return d.person.loadConfig({item:e,personModel:"person"===e.activityData.objectType?e.activityEntityModel:e.eventEntityModels[0]})}},comment:{extractEntitiesFromResponse:function(e){return s(e)},setupView:function(e){return t.getView("base-notification-item-view",{activityItem:e}).then(function(e){return e.initialize()})},constructTemplateConfig:function(n){var o;if("person"===n.activityData.objectType){var a=n.activityEntityModel,l=n.eventEntityModels;return o=i.intlHTMLMessage({intlName:"notifications.NOTIF_1_PERSON_COMMENTED_X_PHOTOS",personName:a.getValue("displayname"),personUrl:a.getValue("url"),photoCountString:n.eventEntityModels.length,mediaType:l[0].getValue("mediaType")}),{headline:o,timestamp:n.timestamp,avatarData:{id:a.getValue("id"),type:n.activityData.objectType,iconUrl:a.getValue("buddyicon").small,url:a.getValue("url")},photos:l.map(function(e){return r(e)}).slice(0,12),hasMultiplePhotos:l.length>1}}if("photo"===n.activityData.objectType){var s=n.activityEntityModel,u=n.eventEntityModels;return o=u.length>1?i.intlHTMLMessage({intlName:"notifications.NOTIF_X_PEOPLE_COMMENTED_1_PHOTO",personName:u[0].getValue("displayname"),personUrl:u[0].getValue("url"),personCountString:e.IntlNumber.format(u.length,t.lang,1),photoTitle:s.getValue("title"),photoUrl:s.getValue("url")}):i.intlHTMLMessage({intlName:"notifications.NOTIF_1_PERSON_COMMENTED_1_PHOTO",personName:u[0].getValue("displayname"),personUrl:u[0].getValue("url"),commentUrl:s.getValue("url")+"/#comment"+n.eventDataList[0].commentid,commentContent:e.StringHelper.stripTags(n.eventDataList[0]._content)}),{headline:o,timestamp:n.timestamp,avatarData:{id:u[0].getValue("id"),type:"person",iconUrl:u[0].getValue("buddyicon").small,url:u[0].getValue("url")},photo:r(s)}}},loadContextMenuConfig:function(e){return d.person.loadConfig({item:e,personModel:"person"===e.activityData.objectType?e.activityEntityModel:e.eventEntityModels[0]})}},reply_reply:{},group_topic_new:{},contacted:{extractEntitiesFromResponse:function(e){return s(e)},setupView:function(e){return t.getView("follow-notification-item-view",{activityItem:e}).then(function(e){return e.initialize()})},constructTemplateConfig:function(e){var t,n=e.eventEntityModels;return t=i.intlHTMLMessage({intlName:"notifications.NOTIF_1_PERSON_FOLLOWED_YOU",personName:n[0].getValue("displayname"),personUrl:n[0].getValue("url")}),{headline:t,timestamp:e.timestamp,avatarData:{id:n[0].getValue("id"),type:"person",iconUrl:n[0].getValue("buddyicon").small,url:n[0].getValue("url")}}},loadContextMenuConfig:function(e){return d.person.loadConfig({item:e,personModel:e.eventEntityModels[0]})}},group_invite:{},note:{extractEntitiesFromResponse:function(e){return s(e)},setupView:function(e){return t.getView("base-notification-item-view",{activityItem:e}).then(function(e){return e.initialize()})},constructTemplateConfig:function(n){var o,a=n.activityEntityModel,l=n.eventEntityModels;return o=l.length>1?i.intlHTMLMessage({intlName:"notifications.NOTIF_X_PEOPLE_LEFT_NOTE_1_PHOTO",personName:l[0].getValue("displayname"),personUrl:l[0].getValue("url"),personCountString:e.IntlNumber.format(l.length,t.lang,1),photoTitle:a.getValue("title"),photoUrl:a.getValue("url")}):i.intlHTMLMessage({intlName:"notifications.NOTIF_1_PERSON_LEFT_NOTE_1_PHOTO",personName:l[0].getValue("displayname"),personUrl:l[0].getValue("url"),noteUrl:a.getValue("url"),noteContent:e.StringHelper.stripTags(n.eventDataList[0]._content)}),{headline:o,timestamp:n.timestamp,avatarData:{id:l[0].getValue("id"),type:"person",iconUrl:l[0].getValue("buddyicon").small,url:l[0].getValue("url")},photo:r(a)}},loadContextMenuConfig:function(e){return d.person.loadConfig({item:e,personModel:e.eventEntityModels[0]})}},tag:{extractEntitiesFromResponse:function(e){return s(e)},setupView:function(e){return t.getView("base-notification-item-view",{activityItem:e}).then(function(e){return e.initialize()})},constructTemplateConfig:function(n){var o,a=n.activityEntityModel,l=n.eventEntityModels;return o=l.length>1?i.intlHTMLMessage({intlName:"notifications.NOTIF_X_PEOPLE_TAGGED_1_PHOTO",personName:l[0].getValue("displayname"),personUrl:l[0].getValue("url"),personCountString:e.IntlNumber.format(l.length,t.lang,1),photoTitle:a.getValue("title"),photoUrl:a.getValue("url")}):i.intlHTMLMessage({intlName:"notifications.NOTIF_1_PERSON_TAGGED_1_PHOTO",personName:l[0].getValue("displayname"),personUrl:l[0].getValue("url"),tagUrl:a.getValue("url"),tagName:e.StringHelper.stripTags(n.eventDataList[0]._content)}),{headline:o,timestamp:n.timestamp,avatarData:{id:l[0].getValue("id"),type:"person",iconUrl:l[0].getValue("buddyicon").small,url:l[0].getValue("url")},photo:r(a)}},loadContextMenuConfig:function(e){return d.person.loadConfig({item:e,personModel:e.eventEntityModels[0]})}},people:{},testimonial:{extractEntitiesFromResponse:function(e){return s(e)},setupView:function(e){return t.getView("testimonial-notification-item-view",{activityItem:e}).then(function(e){return e.initialize()})},constructTemplateConfig:function(e){var n,o=e.eventEntityModels;return n=i.intlHTMLMessage({intlName:"notifications.NOTIF_1_PERSON_TESTIMONIAL",personName:o[0].getValue("displayname"),personUrl:o[0].getValue("url"),testimonialUrl:"/"+t.getViewer().nsid+"/about/#testimonial1234",testimonialContent:"TMP The testimonial content from this notification"}),{headline:n,timestamp:e.timestamp,avatarData:{id:o[0].getValue("id"),type:"person",iconUrl:o[0].getValue("buddyicon").small,url:o[0].getValue("url")}}},loadContextMenuConfig:function(e){return d.person.loadConfig({item:e,personModel:e.eventEntityModels[0]})}},group_user_invite:{},flickrmail:{extractEntitiesFromResponse:function(e){return s(e)},setupView:function(e){return t.getView("base-notification-item-view",{activityItem:e}).then(function(e){return e.initialize()})},constructTemplateConfig:function(t){var n,o=t.eventEntityModels;return n=i.intlHTMLMessage({intlName:"notifications.NOTIF_1_PERSON_FLICKRMAIL",personName:o[0].getValue("displayname"),personUrl:o[0].getValue("url"),flickrmailUrl:"/mail/1234",flickrmailContent:e.StringHelper.stripTags(t.eventDataList[0]._content)}),{headline:n,timestamp:t.timestamp,avatarData:{id:o[0].getValue("id"),type:"person",iconUrl:o[0].getValue("buddyicon").small,url:o[0].getValue("url")}}},loadContextMenuConfig:function(e){return d.person.loadConfig({item:e,personModel:e.eventEntityModels[0]})}},photo_comment_mention:{extractEntitiesFromResponse:function(e){return s(e)},setupView:function(e){return t.getView("base-notification-item-view",{activityItem:e}).then(function(e){return e.initialize()})},constructTemplateConfig:function(n){var o,a=n.activityEntityModel,l=n.eventEntityModels;return o=l.length>1?i.intlHTMLMessage({intlName:"notifications.NOTIF_X_PEOPLE_COMMENT_MENTIONED_YOU_1_PHOTO",personName:l[0].getValue("displayname"),personUrl:l[0].getValue("url"),personCountString:e.IntlNumber.format(l.length,t.lang,1),commentsUrl:a.getValue("url")+"/#comments"}):i.intlHTMLMessage({intlName:"notifications.NOTIF_1_PERSON_COMMENT_MENTIONED_YOU_1_PHOTO",personName:l[0].getValue("displayname"),personUrl:l[0].getValue("url"),commentUrl:a.getValue("url")+"/#comments",commentContent:e.StringHelper.stripTags(n.eventDataList[0]._content)}),{headline:o,timestamp:n.timestamp,avatarData:{id:l[0].getValue("id"),type:"person",iconUrl:l[0].getValue("buddyicon").small,url:l[0].getValue("url")},photo:r(a)}},loadContextMenuConfig:function(e){return d.person.loadConfig({item:e,personModel:e.eventEntityModels[0]})}},gallery:{},gallery_comment:{},share:{},photo_accepted:{},photo_declined:{},photo_mention:{},group_blast:{},upload:{}};var f={extractEntitiesFromResponse:function(t){try{return m[t.type].extractEntitiesFromResponse(t)}catch(t){return e.Promise.resolve({})}},setupView:function(e){var t=e.type;try{return m[t].setupView(e)}catch(e){return}},getTemplateHtml:function(e){var t,n=e.type;try{return t=m[n].constructTemplateConfig(e),g.getTemplate(o[n])(t)}catch(e){return""}},loadContextMenuConfig:function(e){var t=e.type;return m[t].loadContextMenuConfig(e)},getContextMenuConfig:function(e){return d[e.contextMenuType].getConfig(e)},convertNotificationModel:function(e){return{id:e.getValue("id"),seen:e.getValue("isSeen"),isMuted:e.getValue("isMuted"),type:e.getValue("type"),timestamp:e.getValue("timestamp"),model:e,activityData:e.getValue("activityData"),eventDataList:e.getValue("eventDataList"),activityEntityModel:e.getValue("activityEntityModel"),eventEntityModels:e.getValue("eventEntityModels")}}};return e.augment(f,e.EventTarget),f}},"@VERSION@",{requires:["event-custom","template-lib-helper","api-helper","intl-number","string-helper","base-notification-item-view","follow-notification-item-view","testimonial-notification-item-view","hermes-template-notification-core","hermes-template-notif-item-fave","hermes-template-notif-item-comment","hermes-template-notif-item-reply-reply","hermes-template-notif-item-group-topic-new","hermes-template-notif-item-contacted","hermes-template-notif-item-group-invite","hermes-template-notif-item-note","hermes-template-notif-item-tag","hermes-template-notif-item-people","hermes-template-notif-item-testimonial","hermes-template-notif-item-group-user-invite","hermes-template-notif-item-flickrmail","hermes-template-notif-item-photo-comment-mention","hermes-template-notif-item-gallery","hermes-template-notif-item-gallery-comment","hermes-template-notif-item-share","hermes-template-notif-item-photo-accepted","hermes-template-notif-item-photo-declined","hermes-template-notif-item-photo-mention","hermes-template-notif-item-group-blast","hermes-template-notif-item-upload"],langBundles:["common","relative-dates","notifications","profile","photo-card","header"]});YUI.add("hermes-lang-photo-card",function(e,o){e.Intl.add("hermes/photo-card","en-US",{SHARE_THIS_PHOTO:["Share this photo"],SEND_A_MESSAGE:["Send a message"],FOLLOW_USER:['Follow <span class="username-text">',"${username}","</span>"],UNFOLLOW_USER:['Unfollow <span class="username-text">',"${username}","</span>"],BLOCK_USER:['Block <span class="username-text">',"${username}","</span>"],UNBLOCK_USER:['Unblock <span class="username-text">',"${username}","</span>"],SHARE_PHOTOSTREAM:["Share photostream"],SHARE_GROUP:["Share group"],JOIN_GROUP:["Join group"],LEAVE_GROUP:["Leave group"],BLOCK_USER_QUESTION:['Block <span class="username-text">',"${username}","</span>?"],BLOCK_CONFIRM_MESSAGE:["They will not be able to follow you, interact with your photos or videos, or send you FlickrMail. Any comments or faves on your content from them will be deleted, and your content will be removed from their galleries."],BLOCK_CONFIRM_MESSAGE_NOTE:["Note: While the block itself will occur immediately, <b>removal of comments and favorites can take up to several hours</b> (though hopefully not that long!)."],HIDE_FROM_ACTIVITY_FEED:["Hide from activity feed"],SHOW_IN_ACTIVITY_FEED:["Show in activity feed"]})},"@VERSION@",{requires:["intl"]});YUI.add("hermes-lang-header",function(o,e){o.Intl.add("hermes/header","en-US",{EDIT_COVER_PHOTO:["Edit cover photo"],PHOTOSTREAM:["Photostream"],ALBUMS:["Albums"],FAVORITES:["Favorites"],CREATIONS:["Creations"],PHOTO_BOOKS:["Photo Books"],EDIT:["Edit"],PUBLIC:["Public"],ALL:["All"],CHANGE_YOUR_BUDDY_ICON:["Change your Buddy Icon"],CHANGE_YOUR_GROUP_ICON:["Change your group icon"],MEMBER_SINCE:["Member Since"],GROUP_SINCE:["Group Since"],MDY_DATE:[{type:"date",valueName:"mdyDate",format:"medium"}],PHOTOS:["Photos"],VIEWS:["Views"],VIEW_ALL_ALBUMS:["View all albums"],SEND_FLICKR_MAIL:["Send FlickrMail"],BLOCK:["Block"],USERS_GOD_PAGE:["User's God Page"],GROUP_GOD_PAGE:["God"],ADMINISTRATION:["Administration"],DISCUSSIONS:["Discussions"],MEMBERS:["Members"],MAP:["Map"],ABOUT:["About"],INVITE:["Invite Friends"],OVERVIEW:["Overview"],FULLSCREEN:["Fullscreen"],SHARE_THIS_PAGE:["Share this page"],COMMENT:["Comment"],MORE_ACTIONS:["More actions"],THUMBNAIL_VIEW:["Thumbnail view"],GROUP_LIST:["Group List"],CREATE_GROUP:["Create Group"],COVER_PHOTO_CHOOSE:["Choose Cover Photo"],COVER_PHOTO_UPLOAD:["Upload a photo"],COVER_PHOTO_SET_POSITION:["Drag to set position!"],COVER_PHOTO_SAVE:["Save"],COVER_PHOTO_CANCEL:["Cancel"],COVER_PHOTO_LIST_ERROR:["We're having some trouble listing your photos. Try again in a few seconds."],COVER_PHOTO_SELECT_ERROR:["We're having some trouble selecting that photo. Try again in a few seconds."],COVER_PHOTO_POSITION_ERROR:["We're having some trouble positioning that photo. Try again in a few seconds."],COVER_PHOTO_LOW_RESOLUTION:["This photo is small and may not look great as a coverphoto."],COVER_PHOTO_NO_PHOTOS:["Uh oh! No photos here.<br/>What? Do we have to take them for you, too?"],GROUPS_HEADER:["Your Groups"],GROUP_JOIN:["Join Group"],GROUP_JOINED:["Joined"],GROUP_JOIN_REQUESTED:["Join Requested"],GROUP_LEAVE_GROUP:["Leave Group"],GROUPS_OPT_OUT_MESSAGE:["You are viewing the beta version of our new groups experience. Click here to return to the old version."],GROUPS_OPT_IN_MESSAGE:["Go back to the beta groups experience."],STEAMPUNK_OCTOPUS:["Steampunk Octopus"],FOLLOWERS:[{type:"plural",valueName:"count",options:{one:"${#} Follower",other:"${#} Followers"}}],FOLLOWING:[{type:"plural",valueName:"count",options:{one:"${#} Following",other:"${#} Following"}}],FOLLOWER_COUNT:[{type:"plural",valueName:"count",options:{one:["${countString}"," Follower"],other:["${countString}"," Followers"]}}],FOLLOWING_COUNT:[{type:"plural",valueName:"count",options:{one:["${countString}"," Following"],other:["${countString}"," Following"]}}],FOLLOWERS_SIMPLE:["Followers"],FOLLOWING_SIMPLE:["Following"],JOINED_YEAR:["Joined ","${year}"],COUNT_PHOTOS:[{type:"plural",valueName:"count",options:{one:"${#} Photo",other:"${#} Photos"}}],GUESTPASS_HISTORY:["Sharing history"],POSITION_IMAGE:["Position your image"],MIN_ZOOM:["You can't zoom out anymore for this image"],GIFT_PRO:["Gift Pro"],GIVE_PRO:["Give Pro"]})},"@VERSION@",{requires:["intl"]});YUI.add("notifications-list-view",function(t,i){require("hermes-core/flog")(i);t.namespace("Views")[this.name]=t.Base.create("notifications-list-view",t.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(i){this.params=i,this.isLoading=!0,this.pageNum=1,this.notificationsHelper=new t.NotificationsHelper(this.appContext),this.continuationToken="0"},loadState:function(){var t=this,i=this.appContext.getViewer();return this.appContext.getModel("person-notifications-models",i.nsid).then(function(i){t.notificationsModel=i})},buildContainer:function(){this.setContainerWithTemplate("notifications-list",{})},activate:function(){var i=this,n=this.get("container");return this.emptyStateNode=n.one(".notifications-empty-state"),this.flickrBallsNode=n.one(".loading-balls"),this.scrollContainer=n.one(".notifications-list"),this.listNode=n.one(".notification-item-list"),this.scrollContainerHeight=this.scrollContainer.get("clientHeight"),this.toggleLoading(!1),this.loadInitial().then(function(t){return i.appendItems(t)}).then(function(){i.registerEventHandler(i.scrollContainer.on("scroll",t.betterThrottle(i.handleScroll.bind(i),100,i,!1)))})},loadInitial:function(){return this.loadContinuated()},loadContinuated:function(){var t=this;return this.isLoadingMore=!0,this.toggleLoadingBalls(!0),this.notificationsModel.getNotificationsByContinuation({filter:this.notifFilter,continuation:this.continuationToken}).then(function(i){var n=i.notificationModels.map(function(i){return t.notificationsHelper.convertNotificationModel(i)});return t.continuationToken=i.continuation,t.isLoadingMore=!1,t.toggleLoadingBalls(!1),n}).catch(function(i){t.isLoadingMore=!1,t.toggleLoadingBalls(!1)})},appendItems:function(i){var n=this,o=[];return i.forEach(function(t){o.push(n.notificationsHelper.setupView(t))}),t.Promise.all(o).then(function(i){var o=[];return i.forEach(function(i){var e;i&&((e=t.Node.create('<li class="notification-item-list-item"></li>')).appendChild(i.get("container")),n.listNode.appendChild(e),o.push(i.activate()))}),t.Promise.all(o).then(function(){return i})})},toggleLoading:function(t){this.isLoading=t},toggleEmptyState:function(t){this.emptyStateNode.toggleClass("hidden",!t)},handleScroll:function(t){var i=this,n=this.scrollContainer.get("scrollTop"),o=this.scrollContainer.get("scrollHeight");!this.isLoadingMore&&n+this.scrollContainerHeight+100>o&&!this.isAtBottom&&this.loadContinuated().then(function(t){return i.appendItems(t)})},toggleLoadingBalls:function(t){this.flickrBallsNode.toggleClass("hidden",!t)}})},"@VERSION@",{requires:["flickr-view","hermes-template-notifications-list","notifications-helper"],langBundles:["common","notifications","relative-dates"]});YUI.add("notifications-menu-view",function(t){"use strict";t.namespace("Views")[this.name]=t.Base.create("notifications-menu-view",t.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.pollingFailed=!1,this.shouldFetchNotifs=!0,this.notifFilter=["group_topic_new","user_gallery_comment"].join(","),""===this.get("container").get("innerHTML")&&this.setContainerWithTemplate("notifications-menu"),this},loadState:function(){var e=this,i=this.appContext.getViewer();return this.appContext.getModel("person-notifications-models",i.nsid).then(function(n){if(e.set("personNotificationsModel",n),Date.now()-n.getValue("unseenLastFetchedTimestamp")>t.config.flickr.notifications.loading_count_refetch_delay)return n.remoteReadUnseenNotificationCount({id:i.nsid,filter:e.notifFilter},e.appContext).then(null,function(t){e.pollingFailed=!0})})},buildContainer:function(){var t=this.formatCount99(this.get("personNotificationsModel").getValue("unseenNotificationCount"));return this.setContainerWithTemplate("notifications-menu",{unseenNotificationCount:t}),this},activate:function(){var e=this,i=e.get("personNotificationsModel");e.unseenBadge=e.get("container").one(".c-notification-unseencount"),e.unseenCount=0,e.notifIcon=e.get("container").one(".c-notification-icon"),0===i.getValue("unseenNotificationCount")?e.unseenBadge.addClass("hidden"):e.unseenBadge.removeClass("hidden"),t.on("notifications:closeNotificationsMenuClicked",function(t){e.droparound.close()}),this.registerEventHandler(this.get("container").on("click",e.openMenu.bind(e))),this.registerEventHandler(this.get("container").on("key",e.keyboardToggleMenu.bind(e),"down:13,32")),this.registerEventHandler(this.get("container").on("key",e.enterMenu.bind(e),"down:9,40")),e.pollForUnseenNotifs()},pollForUnseenNotifs:function(){this.pollIntervalId=setInterval(this.readUnseenNotifs.bind(this),t.config.flickr.notifications.polling_delay)},readUnseenNotifs:function(){var e=this,i=this.appContext.getViewer();e.get("personNotificationsModel").remoteReadUnseenNotificationCount({id:i.nsid,filter:e.notifFilter},e.appContext).then(function(t){e.shouldFetchNotifs=!0,t!==e.unseenCount&&(e.unseenCount=t,0!==t?(e.unseenBadge.removeClass("hidden"),e.unseenBadge.set("text",e.formatCount99(t))):e.unseenBadge.addClass("hidden"))},function(i){clearInterval(e.pollIntervalId),e.pollingFailed||(e.pollingFailedTimeoutId=setTimeout(e.pollForUnseenNotifs.bind(e),t.config.flickr.notifications.polling_failure_timeout)),e.pollingFailed=!0})},openMenu:function(){this.revealNotifications()},keyboardToggleMenu:function(t){t.preventDefault(),!this.droparound||this.droparound.isClosed?this.revealNotifications():this.droparound.close()},enterMenu:function(t){var e=t.keyCode;if(9===e&&!t.shiftKey&&"true"===t.target.getAttribute("aria-expanded")||40===e){t.preventDefault();var i=this.droparound.get("container").one("div.notifs-droparound");if(i){var n=i.one("a.mail-icon");this.registerEventHandler(n.on("key",this.enterNotificationsList.bind(this),"down:9,40")),n.focus()}}},enterNotificationsList:function(t){var e=t.keyCode;(9===e&&!t.shiftKey||40===e)&&(t.preventDefault(),this.droparound.get("subview").findFocus.call(this,this.droparound.get("container").one("div.notifs-droparound").one("ul").one("li:not(.hidden)")))},revealNotifications:function(){var e,i=this.appContext.viewportData.getWidth(),n=this.appContext.viewportData.getHeight(),o=i>700?60:67,s=i>700?"":i-2+"px",a=n>1e3?"800px":n-200+"px";this.appContext.flipper.isFlipped("enable-notifications-2020")?(e=new t.Views["notifications-list-view"]({appContext:this.appContext}),this.droparound=new t.Views.FluidDroparound({appContext:this.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!0,anchorOffsetVertical:-4,showDropArrow:!0,contentPadding:0,anchorElement:this.get("container").one(".c-notification-icon"),subview:e,observePageResize:!0,positionFixed:!0,autoSizeToContent:!0,preventPageScrollOnScroll:!0}),this.droparound.show(),this.unseenBadge.addClass("hidden"),this.shouldFetchNotifs=!1):((e=new t.Views["notifications-view"]({appContext:this.appContext,width:s,listHeight:a,shouldFetchNotifs:this.shouldFetchNotifs,notifFilter:this.notifFilter})).appContext=this.appContext,this.droparound=new t.Views.FluidDroparound({appContext:this.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!0,anchorOffsetVertical:-4,anchorOffsetHorizontal:o,mirrorArrowAdjustment:o-11,showDropArrow:!0,contentPadding:0,classList:"notifs-droparound no-border big-shadow",anchorElement:this.get("container").one(".c-notification-icon"),subview:e,observePageResize:!0,positionFixed:!0,autoSizeToContent:!0,preventPageScrollOnScroll:!0}),this.droparound.show(),this.unseenBadge.addClass("hidden"),this.shouldFetchNotifs=!1)},formatCount99:function(t){return t>=100?"99+":t},destructor:function(){clearInterval(this.pollIntervalId),clearTimeout(this.pollingFailedTimeoutId)}})},"@VERSION@",{requires:["flickr-view","hermes-template-notifications-menu","fluid-droparound-view","notifications-view","notifications-list-view"],langBundles:["notifications","common"]});YUI.add("hermes-template-person-card",function(a,n){var l=a.Template.Handlebars.revive({1:function(a,n,l,e,t){var s;return"\t\t\t\t\t"+a.escapeExpression(a.lambda(null!=(s=null!=n?n.person:n)?s.realname:s,n))+"\n\t\t\t\t\t"+(null!=(s=l.if.call(null!=n?n:{},null!=n?n.personLocation:n,{name:"if",hash:{},fn:a.program(2,t,0),inverse:a.noop,data:t}))?s:"")+"\n"},2:function(a,n,l,e,t){return" - "},4:function(a,n,l,e,t){var s;return null!=(s=l.each.call(null!=n?n:{},null!=n?n.photostream:n,{name:"each",hash:{},fn:a.program(5,t,0),inverse:a.noop,data:t}))?s:""},5:function(a,n,l,e,t){var s;return null!=(s=l.if.call(null!=n?n:{},null!=n?n.needsInterstitial:n,{name:"if",hash:{},fn:a.program(6,t,0),inverse:a.program(8,t,0),data:t}))?s:""},6:function(a,n,l,e,t){var s,r,i=null!=n?n:{},o=l.helperMissing,u=a.escapeExpression,c=a.lambda;return'\t\t\t\t\t<a href="'+u("function"==typeof(r=null!=(r=l.url||(null!=n?n.url:n))?r:o)?r.call(i,{name:"url",hash:{},data:t}):r)+'" title="'+u("function"==typeof(r=null!=(r=l.title||(null!=n?n.title:n))?r:o)?r.call(i,{name:"title",hash:{},data:t}):r)+'" width="'+u(c(null!=(s=null!=(s=null!=n?n.sizes:n)?s.sq:s)?s.width:s,n))+'" height="'+u(c(null!=(s=null!=(s=null!=n?n.sizes:n)?s.sq:s)?s.height:s,n))+'" style="background: url(https://combo.staticflickr.com/pw/images/spaceball.gif);" data-track="personCardRecentPhotosClick"></a>\n'},8:function(a,n,l,e,t){var s,r,i=null!=n?n:{},o=l.helperMissing,u=a.escapeExpression;return'\t\t\t\t\t<a href="'+u("function"==typeof(r=null!=(r=l.url||(null!=n?n.url:n))?r:o)?r.call(i,{name:"url",hash:{},data:t}):r)+'" title="'+u("function"==typeof(r=null!=(r=l.title||(null!=n?n.title:n))?r:o)?r.call(i,{name:"title",hash:{},data:t}):r)+'" style="background: url('+u(a.lambda(null!=(s=null!=(s=null!=n?n.sizes:n)?s.sq:s)?s.displayUrl:s,n))+');" data-track="personCardRecentPhotosClick"></a>\n'},10:function(a,n,l,e,t){return'\t\t\t<span class="tertiary">'+a.escapeExpression((l.intlMessage||n&&n.intlMessage||l.helperMissing).call(null!=n?n:{},{name:"intlMessage",hash:{intlName:"person.NO_PHOTOS"},data:t}))+"</span>\n"},compiler:[7,">= 4.0.0"],main:function(a,n,l,e,t){var s,r,i=null!=n?n:{},o=l.helperMissing,u=a.escapeExpression,c=a.lambda;return'\n<div>\n\t<section>\n\t\t<div class="follow-subview">'+u((l.outlet||n&&n.outlet||o).call(i,null!=n?n["follow-view"]:n,{name:"outlet",hash:{},data:t}))+'</div>\n\n\t\t<div class="attribution">\n\t\t\t<a href="'+u(c(null!=(s=null!=n?n.personURLS:n)?s.photostream:s,n))+'" data-track="personCardAttributionNameClick">\n\t\t\t\t<h3 class="fade-out">'+u(c(null!=(s=null!=n?n.person:n)?s.username:s,n))+'</h3>\n\t\t\t</a>\n\t\t</div>\n\t\t<div class="info">\n\t\t\t<span class="secondary realname fade-out">\n'+(null!=(s=l.if.call(i,null!=(s=null!=n?n.person:n)?s.realname:s,{name:"if",hash:{},fn:a.program(1,t,0),inverse:a.noop,data:t}))?s:"")+"\t\t\t\t"+u("function"==typeof(r=null!=(r=l.personLocation||(null!=n?n.personLocation:n))?r:o)?r.call(i,{name:"personLocation",hash:{},data:t}):r)+'\n\t\t\t</span>\n\t\t</div>\n\n\t\t<div class="recent-photos">\n'+(null!=(s=l.if.call(i,null!=n?n.photostream:n,{name:"if",hash:{},fn:a.program(4,t,0),inverse:a.program(10,t,0),data:t}))?s:"")+'\t\t</div>\n\t</section>\n</div>\n\n<div class="links secondary">\n\t<a href="'+u(c(null!=(s=null!=n?n.personURLS:n)?s.sendFlickrMail:s,n))+'" data-track="personCardMessageClick">'+u((l.intlMessage||n&&n.intlMessage||o).call(i,{name:"intlMessage",hash:{intlName:"person.MESSAGE"},data:t}))+'</a>\n\t<a href="'+u(c(null!=(s=null!=n?n.personURLS:n)?s.albums:s,n))+'" data-track="personCardAlbumsClick">'+u((l.intlMessage||n&&n.intlMessage||o).call(i,{name:"intlMessage",hash:{intlName:"person.ALBUMS"},data:t}))+'</a>\n\t<a href="'+u(c(null!=(s=null!=n?n.personURLS:n)?s.favorites:s,n))+'" data-track="personCardFavesClick">'+u((l.intlMessage||n&&n.intlMessage||o).call(i,{name:"intlMessage",hash:{intlName:"person.FAVES"},data:t}))+'</a>\n\t<a class="align-right" href="'+u(c(null!=(s=null!=n?n.personURLS:n)?s.profile:s,n))+'" data-track="personCardProfileClick">'+u((l.intlMessage||n&&n.intlMessage||o).call(i,{name:"intlMessage",hash:{intlName:"common.ABOUT"},data:t}))+"</a>\n</div>\n"},useData:!0}),e={};a.Array.each([],function(n){var l=a.Template.get("hermes/"+n);l&&(e[n]=l)}),a.Template.register("hermes/person-card",function(n,t){return t=t||{},t.partials=t.partials?a.merge(e,t.partials):e,l(n,t)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("person-card-view",function(e){e.namespace("Views")[this.name]=e.Base.create("person-card-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.nsid=e.nsid,this.pathAlias=e.pathAlias,this.set("isActiveViewAgnostic",e.isActiveViewAgnostic||!1),""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this},subviewConfig:{"follow-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1}},loadState:function(){var t=this,s={contentType:7};return this.nsid?s.id=this.nsid:s.pathAlias=this.pathAlias,new e.FlickrPromise({person:this.appContext.getModel("person-models",s),photostream:this.appContext.getModel("photostream-models",s),personProfile:this.appContext.getModel("person-profile-models",s)}).then(function(e){return t.personModel=e.person,t.personLocation=e.personProfile.getValue("location"),e.photostream.getValue("photoPageList").getPage({page:1,perPage:5}).then(function(e){t.photostreamPhotos=e})},function(e){t.loadingError=!0,1===e.code&&"User not found"===e.message&&(t.badUser=!0)})},buildContainer:function(){var t,s;return this.loadingError?(s=this.badUser?'<span class="no-user">'+this.intlMessage({intlName:"person.NO_LONGER_ON_FLICKR"})+"</span>":'<span class="error-user">'+this.intlMessage({intlName:"person.ERROR_LOADING"})+"</span>",this.setContainerHTML(s)):(t=this.personModel.toJSON(),this.setContainerWithTemplate("person-card",{person:t,photostream:this.photostreamPhotos.map(function(e){return e.toJSON()}),personLocation:this.personLocation,personURLS:e.URLHelper.generatePersonUrls(this.personModel)})),this},activate:function(){var e=this.get("container"),t=e.one(".follow-view"),s=t.one(".relationship"),o=t.one(".relationship > .is-following"),n=e.one(".attribution");return s?o&&n.addClass("shorter"):n.addClass("full"),this}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-person-card","url-helper"],langBundles:["person","common"]});